<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0">
  <title>Multi-Seller Search - Material Design</title>

  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
    rel="stylesheet">

  <style>
    body {
      background-color: #f4f4f4;
      color: #333;
    }

    .container {
      margin-top: 30px;
    }

    .card-panel {
      padding: 24px;
    }

    h1 {
      font-size: 2.2rem;
      /* Adjust H1 size for Material feel */
      margin-bottom: 2rem;
    }

    /* Add some margin between buttons */
    .btn,
    .btn-large,
    .btn-small {
      margin-right: 10px;
      margin-bottom: 10px;
      /* For stacking on small screens */
    }

    #linksContainer ul {
      margin-top: 10px;
    }

    #linksContainer li a {
      display: block;
      /* Make entire list item clickable area bigger */
      padding: 8px 0;
      color: #007bff;
      /* Or use Materialize primary color */
    }

    #linksContainer li a:hover {
      text-decoration: underline;
    }
  </style>
</head>

<body>

  <div class="container">
    <div class="card-panel">
      <h1 class="center-align">Multi-Seller Product Search</h1>

      <div class="row">
        <div class="input-field col s12 m6">
          <i class="material-icons prefix">search</i>
          <input type="text"
            id="keyword"
            placeholder="Enter product keyword">
          <label for="keyword">Search Keyword:</label>
        </div>

        <div class="input-field col s12 m6">
          <i class="material-icons prefix">category</i>
          <select id="category">
            <option value=""
              disabled
              selected>Choose your category</option>
          </select>
          <label for="category">Select Category:</label>
        </div>
      </div>

      <div class="row center-align"
        style="margin-top: 20px;">
        <button class="btn waves-effect waves-light blue darken-2"
          onclick="openSellerTabs()">
          Open in New Tabs
          <i class="material-icons right">open_in_new</i>
        </button>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script>
    // Initialize Materialize components
    document.addEventListener('DOMContentLoaded', function () {
      M.AutoInit(); // Initializes all Materialize components
      // Or, if you want to be specific:
      // var selectElems = document.querySelectorAll('select');
      // M.FormSelect.init(selectElems);
    });

    // Seller groups data
    const sellerGroups = {
      computer: [
        'https://www.tokopedia.com/gamingpcstore', 'https://www.tokopedia.com/multipro-id',
        'https://www.tokopedia.com/enterkomputer', 'https://www.tokopedia.com/cockomputer',
        'https://www.tokopedia.com/nanokomputer', 'https://www.tokopedia.com/rakitancom',
        'https://www.tokopedia.com/duniastorage', 'https://www.tokopedia.com/nvidiageforce',
        'https://www.tokopedia.com/gasol', 'https://www.tokopedia.com/tokoexpert',
        'https://www.tokopedia.com/distributorpc', 'https://www.tokopedia.com/imbapc',
        'https://www.tokopedia.com/tonixcomp', 'https://www.tokopedia.com/redteknologi',
        'https://www.tokopedia.com/jayapc', 'https://www.tokopedia.com/amd-component',
        'https://www.tokopedia.com/it-shoponline', 'https://www.tokopedia.com/msi-id',
        'https://www.tokopedia.com/agreskomputerofficial', 'https://www.tokopedia.com/onelinegamepc'
      ],
      skincare: [
        'https://www.tokopedia.com/schminkhaus', 'https://www.tokopedia.com/nihonmart',
        'https://www.tokopedia.com/klairsid', 'https://www.tokopedia.com/thenakedseries',
        'https://www.tokopedia.com/beautyhaulindo', 'https://www.tokopedia.com/beautyofjoseon',
        'https://www.tokopedia.com/skin-1004', 'https://www.tokopedia.com/venuss8'
      ],
    };

    // Function to populate the category dropdown
    function populateCategories() {
      const categorySelect = document.getElementById('category');
      if (categorySelect) {
        // Clear existing options except the disabled one
        while (categorySelect.options.length > 1) {
          categorySelect.remove(1);
        }
        Object.keys(sellerGroups).forEach(categoryName => {
          const option = document.createElement('option');
          option.value = categoryName;
          option.textContent = categoryName.charAt(0).toUpperCase() + categoryName.slice(1);
          categorySelect.appendChild(option);
        });
        // Re-initialize the select if options are added dynamically after M.AutoInit()
        M.FormSelect.init(categorySelect);
      } else {
        console.error("Category select element not found.");
      }
    }

    // Call populateCategories on load, but after Materialize might have initialized.
    // DOMContentLoaded is generally better for this.
    document.addEventListener('DOMContentLoaded', function () {
      populateCategories(); // Populate categories first
      M.AutoInit();       // Then initialize Materialize components
    });


    function getKeywordAndCategory() {
      const keywordInput = document.getElementById('keyword');
      const categorySelect = document.getElementById('category');

      if (!keywordInput || !categorySelect) {
        M.toast({ html: 'Error: Input or select element not found!', classes: 'red' });
        return null;
      }

      const keyword = keywordInput.value.trim();
      const selectedCategory = categorySelect.value;

      if (!keyword) {
        M.toast({ html: 'Please enter a search keyword.', classes: 'orange' });
        return null;
      }

      if (!selectedCategory || !sellerGroups[selectedCategory]) {
        M.toast({ html: 'Please select a valid category.', classes: 'orange' });
        return null;
      }
      return { keyword, selectedCategory, baseUrls: sellerGroups[selectedCategory] };
    }

    // Function to open seller tabs
    function openSellerTabs() {
      const searchData = getKeywordAndCategory();
      if (!searchData) return;

      const { keyword, baseUrls } = searchData;

      baseUrls.forEach(baseUrl => {
        const searchUrl = `${baseUrl}/product?q=${encodeURIComponent(keyword)}`;
        try {
          const newTab = window.open(searchUrl, '_blank');
          if (newTab) {
            newTab.focus();
          } else {
            console.warn(`Could not open tab for ${searchUrl}. It might have been blocked.`);
            M.toast({ html: `Popup blocked for ${baseUrl}. Check browser settings.`, classes: 'red', displayLength: 5000 });
          }
        } catch (e) {
          console.error(`Error opening tab for ${searchUrl}:`, e);
          M.toast({ html: `Error opening tab for ${baseUrl}.`, classes: 'red' });
        }
      });
    }
  </script>
</body>

</html>